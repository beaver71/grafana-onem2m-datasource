{"version":3,"sources":["../src/query_ctrl.js"],"names":["QueryCtrl","GenericDatasourceQueryCtrl","$scope","$injector","scope","target","type","field","datasource","metricGetJson","then","console","log","json_sample","query","metricFindQuery","metricFindFields","rawQuery","panelCtrl","refresh","templateUrl"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAQA,qB,kBAAAA,S;;;;;;;;;;;;;;;;;;;;;kDAGKC,0B;;;AAET,oDAAYC,MAAZ,EAAoBC,SAApB,EAA+B;AAAA;;AAAA,wKACrBD,MADqB,EACbC,SADa;;AAG3B,0BAAKC,KAAL,GAAaF,MAAb;AACA,0BAAKG,MAAL,CAAYA,MAAZ,GAAqB,MAAKA,MAAL,CAAYA,MAAZ,IAAsB,eAA3C;AACA,0BAAKA,MAAL,CAAYC,IAAZ,GAAmB,MAAKD,MAAL,CAAYC,IAAZ,IAAoB,WAAvC;AACA,0BAAKD,MAAL,CAAYE,KAAZ,GAAoB,MAAKF,MAAL,CAAYE,KAAZ,IAAqB,EAAzC;;AAEA,0BAAKC,UAAL,CAAgBC,aAAhB,CAA8B,MAAKJ,MAAnC,EAA2CK,IAA3C,CAAgD,uBAAe;AAC3DC,gCAAQC,GAAR,CAAY,iBAAZ,EAA+BC,WAA/B;AACA,8BAAKT,KAAL,CAAWS,WAAX,GAAyBA,WAAzB;AACH,qBAHD;;AAKAF,4BAAQC,GAAR,CAAY,4BAAZ,EAA0C,MAAKP,MAA/C;AAb2B;AAc9B;;;;+CAEUS,K,EAAO;AACd,+BAAO,KAAKN,UAAL,CAAgBO,eAAhB,CAAgCD,SAAS,EAAzC,CAAP;AACH;;;8CAESA,K,EAAO;AACb,+BAAO,KAAKN,UAAL,CAAgBQ,gBAAhB,CAAiCF,SAAS,EAA1C,EAA8C,KAAKT,MAAnD,CAAP;AACH;;;uDAEkB;AACf,6BAAKA,MAAL,CAAYY,QAAZ,GAAuB,CAAC,KAAKZ,MAAL,CAAYY,QAApC;AACH;;;uDAEkB;AACfN,gCAAQC,GAAR,CAAY,gCAAZ,EAA8C,KAAKP,MAAnD;AACA,6BAAKa,SAAL,CAAeC,OAAf,GAFe,CAEW;AAC7B;;;;cAjC2CnB,S;;;;AAoChDC,uCAA2BmB,WAA3B,GAAyC,4BAAzC","file":"query_ctrl.js","sourcesContent":["import {QueryCtrl} from 'app/plugins/sdk';\r\nimport './css/query-editor.css!'\r\n\r\nexport class GenericDatasourceQueryCtrl extends QueryCtrl {\r\n\r\n    constructor($scope, $injector) {\r\n        super($scope, $injector);\r\n\r\n        this.scope = $scope;\r\n        this.target.target = this.target.target || 'select metric';\r\n        this.target.type = this.target.type || 'timeserie';\r\n        this.target.field = this.target.field || {};\r\n        \r\n        this.datasource.metricGetJson(this.target).then(json_sample => {\r\n            console.log(\"   >json_sample\", json_sample);\r\n            this.scope.json_sample = json_sample;\r\n        });\r\n        \r\n        console.log(\"GenericDatasourceQueryCtrl\", this.target);\r\n    }\r\n\r\n    getOptions(query) {\r\n        return this.datasource.metricFindQuery(query || '');\r\n    }\r\n\r\n    getFields(query) {\r\n        return this.datasource.metricFindFields(query || '', this.target);\r\n    }\r\n\r\n    toggleEditorMode() {\r\n        this.target.rawQuery = !this.target.rawQuery;\r\n    }\r\n\r\n    onChangeInternal() {\r\n        console.log(\"onChangeInternal: this.target=\", this.target);\r\n        this.panelCtrl.refresh(); // Asks the panel to refresh data.\r\n    }\r\n}\r\n\r\nGenericDatasourceQueryCtrl.templateUrl = 'partials/query.editor.html';\r\n\r\n"]}